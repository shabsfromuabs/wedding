var win = $(window);

win.load(function () {
    //$('#cover-video')[0].play();
});

$(document).ready(function () {
    fitVideoContainer();
    setNavBarClass();

    win.resize(debounce(fitVideoContainer, 100));
    win.scroll(setNavBarClass);

    $('.scroll-down').click(function () {
        var topSection = $('.jumbotron.top-section');
        $('html, body').stop().animate({scrollTop: topSection.outerHeight() - 70});
    });

    $('a.scroll-link').click(function () {
        var targetElement = $($(this).attr('href'));
        $('html, body').stop().animate({scrollTop: targetElement.length ? targetElement.offset().top - 90 : 0});
        return false;
    });
});

var map, marker;

function initMap() {
    var coordinates = {lat: 50.914034, lng: 34.753893};

    map = new google.maps.Map(document.getElementById('map-wrap'), {
        center: coordinates,
        zoom: 15,
        mapTypeControl: false
    });

    marker = new google.maps.Marker({
        position: coordinates,
        title: 'Ресторан "Порт Рояль"',
        animation: google.maps.Animation.DROP,
        icon: '<%= asset_path 'map-marker.png' %>'
    });
}

$(document).ready(function() {
    var win = $(window);
    var mapWrapOffset = $('#map-wrap').offset();

    win.bind('scroll', setMapMarker);
    setMapMarker();

    function setMapMarker() {
        if (map && win.height() + win.scrollTop() > mapWrapOffset.top + 200) {
            setTimeout(function () {
                marker.setMap(map);
            }, 500);
            win.unbind('scroll', setMapMarker);
        }
    }
});
